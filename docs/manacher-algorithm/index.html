<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Manacher's Algorithm | Sá»• tay cá»§a Henry</title><meta name=keywords content="math,algorithm"><meta name=description content="MÃ¬nh má»›i gáº·p vÃ  tÃ¬m hiá»ƒu thuáº­t toÃ¡n nÃ y má»›i Ä‘Ã¢y thÃ´i ğŸ³, khi Ä‘ang lÃ m 1 bÃ i trÃªn leetcode ğŸ˜ƒ
Tháº¿ nÃ o lÃ  1 Palindrome ? MÃ¬nh hiá»ƒu palindrome lÃ  1 chuá»—i kÃ½ tá»± Ä‘á»‘i xá»©ng. VÃ­ dá»¥:
Chuá»—i &ldquo;cabadabac&rdquo; lÃ  1 palindrome. VÃ¬ chuá»—i nÃ y Ä‘á»‘i xá»©ng qua kÃ½ tá»± &rsquo;d&rsquo; á»Ÿ vá»‹ trÃ­ 4 (tÃ­nh tá»« 0, theo cÃ¡ch index trong javascript). Hay chuá»—i &ldquo;acbaabca&rdquo; cÅ©ng lÃ  1 palindrome, chuá»—i nÃ y Ä‘á»‘i xá»©ng qua vá»‹ trÃ­ giá»¯a 2 kÃ½ tá»± &lsquo;a&rsquo;."><meta name=author content="Ngo Van Trung"><link rel=canonical href=https://TrungNgoVan.github.io/blog/docs/manacher-algorithm/><link crossorigin=anonymous href=/blog/assets/css/stylesheet.f4609a383e3709a645f04e13d4129372693d13a8636500ddef16d617cfef25a4.css integrity="sha256-9GCaOD43CaZF8E4T1BKTcmk9E6hjZQDd7xbWF8/vJaQ=" rel="preload stylesheet" as=style><link rel=icon href=https://TrungNgoVan.github.io/blog/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://TrungNgoVan.github.io/blog/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://TrungNgoVan.github.io/blog/favicon-32x32.png><link rel=apple-touch-icon href=https://TrungNgoVan.github.io/blog/apple-touch-icon.png><link rel=mask-icon href=https://TrungNgoVan.github.io/blog/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.7/dist/katex.min.css integrity=sha384-3UiQGuEI4TTMaFmGIZumfRPtfKQ3trwQE2JgosJxCnGmQpL/lJdjpcHkaaFwHlcI crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.7/dist/katex.min.js integrity=sha384-G0zcxDFp5LWZtDuRMnBkk3EphCK1lhEf4UEyEM693ka574TZGwo4IWwS6QLzM/2t crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.7/dist/contrib/auto-render.min.js integrity=sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05 crossorigin=anonymous></script>
<script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}],throwOnError:!1})})</script><meta property="og:title" content="Manacher's Algorithm"><meta property="og:description" content="MÃ¬nh má»›i gáº·p vÃ  tÃ¬m hiá»ƒu thuáº­t toÃ¡n nÃ y má»›i Ä‘Ã¢y thÃ´i ğŸ³, khi Ä‘ang lÃ m 1 bÃ i trÃªn leetcode ğŸ˜ƒ
Tháº¿ nÃ o lÃ  1 Palindrome ? MÃ¬nh hiá»ƒu palindrome lÃ  1 chuá»—i kÃ½ tá»± Ä‘á»‘i xá»©ng. VÃ­ dá»¥:
Chuá»—i &ldquo;cabadabac&rdquo; lÃ  1 palindrome. VÃ¬ chuá»—i nÃ y Ä‘á»‘i xá»©ng qua kÃ½ tá»± &rsquo;d&rsquo; á»Ÿ vá»‹ trÃ­ 4 (tÃ­nh tá»« 0, theo cÃ¡ch index trong javascript). Hay chuá»—i &ldquo;acbaabca&rdquo; cÅ©ng lÃ  1 palindrome, chuá»—i nÃ y Ä‘á»‘i xá»©ng qua vá»‹ trÃ­ giá»¯a 2 kÃ½ tá»± &lsquo;a&rsquo;."><meta property="og:type" content="article"><meta property="og:url" content="https://TrungNgoVan.github.io/blog/docs/manacher-algorithm/"><meta property="og:image" content="https://TrungNgoVan.github.io/blog/images/example.jpg"><meta property="article:section" content="docs"><meta property="article:published_time" content="2023-06-12T17:27:53+07:00"><meta property="article:modified_time" content="2023-06-12T17:27:53+07:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://TrungNgoVan.github.io/blog/images/example.jpg"><meta name=twitter:title content="Manacher's Algorithm"><meta name=twitter:description content="MÃ¬nh má»›i gáº·p vÃ  tÃ¬m hiá»ƒu thuáº­t toÃ¡n nÃ y má»›i Ä‘Ã¢y thÃ´i ğŸ³, khi Ä‘ang lÃ m 1 bÃ i trÃªn leetcode ğŸ˜ƒ
Tháº¿ nÃ o lÃ  1 Palindrome ? MÃ¬nh hiá»ƒu palindrome lÃ  1 chuá»—i kÃ½ tá»± Ä‘á»‘i xá»©ng. VÃ­ dá»¥:
Chuá»—i &ldquo;cabadabac&rdquo; lÃ  1 palindrome. VÃ¬ chuá»—i nÃ y Ä‘á»‘i xá»©ng qua kÃ½ tá»± &rsquo;d&rsquo; á»Ÿ vá»‹ trÃ­ 4 (tÃ­nh tá»« 0, theo cÃ¡ch index trong javascript). Hay chuá»—i &ldquo;acbaabca&rdquo; cÅ©ng lÃ  1 palindrome, chuá»—i nÃ y Ä‘á»‘i xá»©ng qua vá»‹ trÃ­ giá»¯a 2 kÃ½ tá»± &lsquo;a&rsquo;."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Docs","item":"https://TrungNgoVan.github.io/blog/docs/"},{"@type":"ListItem","position":2,"name":"Manacher's Algorithm","item":"https://TrungNgoVan.github.io/blog/docs/manacher-algorithm/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Manacher's Algorithm","name":"Manacher\u0027s Algorithm","description":"MÃ¬nh má»›i gáº·p vÃ  tÃ¬m hiá»ƒu thuáº­t toÃ¡n nÃ y má»›i Ä‘Ã¢y thÃ´i ğŸ³, khi Ä‘ang lÃ m 1 bÃ i trÃªn leetcode ğŸ˜ƒ\nTháº¿ nÃ o lÃ  1 Palindrome ? MÃ¬nh hiá»ƒu palindrome lÃ  1 chuá»—i kÃ½ tá»± Ä‘á»‘i xá»©ng. VÃ­ dá»¥:\nChuá»—i \u0026ldquo;cabadabac\u0026rdquo; lÃ  1 palindrome. VÃ¬ chuá»—i nÃ y Ä‘á»‘i xá»©ng qua kÃ½ tá»± \u0026rsquo;d\u0026rsquo; á»Ÿ vá»‹ trÃ­ 4 (tÃ­nh tá»« 0, theo cÃ¡ch index trong javascript). Hay chuá»—i \u0026ldquo;acbaabca\u0026rdquo; cÅ©ng lÃ  1 palindrome, chuá»—i nÃ y Ä‘á»‘i xá»©ng qua vá»‹ trÃ­ giá»¯a 2 kÃ½ tá»± \u0026lsquo;a\u0026rsquo;.","keywords":["math","algorithm"],"articleBody":"MÃ¬nh má»›i gáº·p vÃ  tÃ¬m hiá»ƒu thuáº­t toÃ¡n nÃ y má»›i Ä‘Ã¢y thÃ´i ğŸ³, khi Ä‘ang lÃ m 1 bÃ i trÃªn leetcode ğŸ˜ƒ\nTháº¿ nÃ o lÃ  1 Palindrome ? MÃ¬nh hiá»ƒu palindrome lÃ  1 chuá»—i kÃ½ tá»± Ä‘á»‘i xá»©ng. VÃ­ dá»¥:\nChuá»—i â€œcabadabacâ€ lÃ  1 palindrome. VÃ¬ chuá»—i nÃ y Ä‘á»‘i xá»©ng qua kÃ½ tá»± â€™dâ€™ á»Ÿ vá»‹ trÃ­ 4 (tÃ­nh tá»« 0, theo cÃ¡ch index trong javascript). Hay chuá»—i â€œacbaabcaâ€ cÅ©ng lÃ  1 palindrome, chuá»—i nÃ y Ä‘á»‘i xá»©ng qua vá»‹ trÃ­ giá»¯a 2 kÃ½ tá»± â€˜aâ€™.\nÄá»ƒ dá»… hÃ¬nh dung hÆ¡n, cÃ¡c báº¡n cÃ³ thá»ƒ tÆ°á»Ÿng tÆ°á»Ÿng 1 palindrome Ä‘Æ°á»£c táº¡o ra báº±ng cÃ¡ch pháº£n chiáº¿u 1 chuá»—i kÃ½ tá»± qua â€œgÆ°Æ¡ngâ€.\nVáº­y sub-palindromes (cÃ²n gá»i lÃ  palindrome substrings) lÃ  cÃ¡c chuá»—i con cá»§a má»™t chuá»—i ban Ä‘áº§u vÃ  lÃ  palindrome.\nTheo mÃ¬nh tÃ¬m hiá»ƒu thÃ¬ sub-palindromes lÃ  má»™t khÃ¡i niá»‡m quan trá»ng trong xá»­ lÃ½ chuá»—i vÃ  cÃ³ á»©ng dá»¥ng trong nhiá»u bÃ i toÃ¡n, bao gá»“m tÃ¬m kiáº¿m tá»«, mÃ£ hÃ³a, nÃ©n dá»¯ liá»‡u vÃ  xá»­ lÃ½ ngÃ´n ngá»¯ tá»± nhiÃªn. Trong bÃ i viáº¿t nÃ y mÃ¬nh sáº½ nÃ³i Ä‘áº¿n 1 bÃ i toÃ¡n khÃ¡ hay. Go go ğŸ³\nBÃ i toÃ¡n: TÃ¬m táº¥t cáº£ cÃ¡c sub-palindromes trong thá»i gian $O(n)$ BÃ i toÃ¡n: Cho chuá»—i $s$â€Švá»›i Ä‘á»™ dÃ i $n$â€Š. TÃ¬m táº¥t cáº£ cÃ¡c cáº·p $(i, j)$â€Šsao cho chuá»—i con $s[i\\dots j]$â€ŠlÃ  má»™t chuá»—i Ä‘á»‘i xá»©ng. Chuá»—i $t$â€ŠlÃ  má»™t chuá»—i Ä‘á»‘i xá»©ng khi $t = t_{rev}$â€Š(â€Š$t_{rev}$â€ŠlÃ  má»™t chuá»—i Ä‘áº£o ngÆ°á»£c cá»§a $t$â€Š).\nPhÃ¢n tÃ­ch: Chuá»—i Ä‘á»‘i xá»©ng á»Ÿ Ä‘Ã¢y chÃ­nh lÃ  palindrome mÃ¬nh Ä‘Ã£ Ä‘á» cáº­p á»Ÿ trÃªn.\nTrong trÆ°á»ng há»£p xáº¥u nháº¥t, chuá»—i ban Ä‘áº§u cÃ³ thá»ƒ cÃ³ tá»›i $O(n^2)$â€Šchuá»—i con Ä‘á»‘i xá»©ng. LÃºc Ä‘áº§u mÃ¬nh nhÃ¬n qua thÃ¬ nghÄ© lÃ  khÃ´ng cÃ³ thuáº­t toÃ¡n tuyáº¿n tÃ­nh nÃ o cho bÃ i toÃ¡n nÃ y. Tá»©c lÃ  sáº½ khÃ´ng cÃ³ bÃ i viáº¿t nÃ y ğŸ‘€\nPhÃ¢n tÃ­ch ká»¹ hÆ¡n ğŸ”: CÃ¡c palindrome sáº½ cÃ³ Ä‘á»™ dÃ i láº» vÃ  cháºµn khÃ¡c nhau, vÃ  Ä‘Æ°á»£c tÃ­nh riÃªng lÃ  $d_{odd}[i]$â€ŠvÃ  $d_{even}[i]$â€Š. Äá»‘i vá»›i cÃ¡c palindrome cÃ³ Ä‘á»™ dÃ i cháºµn, chÃºng ta giáº£ Ä‘á»‹nh ráº±ng chÃºng cÃ³ tÃ¢m á»Ÿ vá»‹ trÃ­ $i$â€Šnáº¿u hai kÃ½ tá»± trung tÃ¢m cá»§a chÃºng lÃ  $s[i]$â€ŠvÃ  $s[i-1]$â€Š.\nVÃ­ dá»¥, chuá»—i $s = abababc$â€ŠcÃ³ 3 palindromes cÃ³ Ä‘á»™ dÃ i láº» vá»›i tÃ¢m á»Ÿ vá»‹ trÃ­ $s[3] = b$â€Š, tá»©c lÃ  $d_{odd}[3] = 3$â€Š:\nVÃ  chuá»—i $s = cbaabd$â€ŠcÃ³ 2 palindromes cÃ³ Ä‘á»™ dÃ i báº±ng nhau vá»›i tÃ¢m á»Ÿ vá»‹ trÃ­ $s[3] = a$â€Š, tá»©c lÃ  $d_{even}[3] = 2$â€Š:\nThá»±c táº¿, váº¥n Ä‘á» nÃ y Ä‘Ã£ cÃ³ nhiá»u giáº£i phÃ¡p: vá»›i String Hashing, nÃ³ cÃ³ thá»ƒ Ä‘Æ°á»£c giáº£i quyáº¿t trong $O(n\\cdot \\log n)$â€Š, vÃ  vá»›i Suffix Trees vÃ  Fast LCA , váº¥n Ä‘á» nÃ y cÃ³ thá»ƒ Ä‘Æ°á»£c giáº£i quyáº¿t trong $O(n)$â€Š. CÃ¡c báº¡n cÃ³ thá»ƒ tá»± tÃ¬m hiá»ƒu.\nNhÆ°ng thuáº­t toÃ¡n mÃ¬nh nÃ³i trong Ä‘áº¿n trong bÃ i nÃ y Ä‘Æ¡n giáº£n hÆ¡n vÃ  cÃ³ Ã­t háº±ng sá»‘ áº©n hÆ¡n vá» Ä‘á»™ phá»©c táº¡p cá»§a bá»™ nhá»› vÃ  thá»i gian. Thuáº­t toÃ¡n nÃ y Ä‘Æ°á»£c phÃ¡t hiá»‡n bá»Ÿi Glenn K. Manacher vÃ o nÄƒm 1975.\nVá» Ã½ tÆ°á»Ÿng cá»‘t lÃµi lÃ  tÃ­nh toÃ¡n sá»‘ lÆ°á»£ng palindrome hiá»‡n táº¡i dá»±a trÃªn thÃ´ng tin palindrome Ä‘Æ°á»£c tÃ­nh toÃ¡n trÆ°á»›c Ä‘Ã³. Nghe giá»‘ng DP nhá»‰ ğŸ‘€\nCode thÃ´i ğŸ’» Suy nghÄ© chÃºt ğŸ¤” Äá»ƒ xá»­ lÃ½ váº¥n Ä‘á» palindrome cÃ³ Ä‘á»™ dÃ i láº» vÃ  cháºµn khÃ¡c nhau, thay vÃ¬ tÃ­nh toÃ¡n cho cáº£ 2 trÆ°á»ng há»£p. ChÃºng ta sáº½ biáº¿n Ä‘á»•i chuá»—i ban Ä‘áº§u 1 chÃºt. Cá»¥ thá»ƒ, mÃ¬nh sáº½ thÃªm kÃ½ tá»± # vÃ o Ä‘áº§u, cuá»‘i vÃ  giá»¯a cÃ¡c kÃ½ tá»± cá»§a chuá»—i ban Ä‘áº§u. TrÃ´ng nÃ³ sáº½ nhÆ° váº­y:\nSau khi modify chuá»—i, chÃºng ta sáº½ luÃ´n thu Ä‘Æ°á»£c 1 chuá»—i má»›i cÃ³ Ä‘á»™ dÃ i láº». VÃ  sáº½ khÃ´ng cÃ³ trÆ°á»ng há»£p palindrome cÃ³ Ä‘á»™ dÃ i cháºµn táº¡o bá»Ÿi cÃ¡c kÃ½ tá»± trong chuá»—i ban Ä‘áº§u.\nBá»Ÿi vÃ¬ giá»¯a chÃºng luÃ´n cÃ³ kÃ½ tá»± â€™#â€™. Do Ä‘Ã³ chÃºng ta Ä‘Ã£ bá» qua Ä‘Æ°á»£c váº¥n Ä‘á» pháº£i tÃ­nh toÃ¡n sá»‘ lÆ°á»£ng cÃ¡c palindromes cÃ³ Ä‘á»™ dÃ i cháºµn.\nVáº­y giá» mÃ¬nh chá»‰ cáº§n tÃ¬m sá»‘ lÆ°á»£ng cÃ¡c palindrome láº» vÃ  lÆ°u láº¡i. ğŸ‘€ Nghe dá»… nhá»‰\nThuáº­t toÃ¡n ğŸ“ Khá»Ÿi táº¡o má»™t biáº¿n Ä‘áº¿m tÃªn res Ä‘á»ƒ theo dÃµi sá»‘ lÆ°á»£ng xÃ¢u Ä‘á»‘i xá»©ng. Táº¡o má»™t chuá»—i Ä‘Æ°á»£c sá»­a Ä‘á»•i newS báº±ng cÃ¡ch chÃ¨n kÃ½ tá»± # giá»¯a má»—i kÃ½ tá»± cá»§a chuá»—i Ä‘áº§u vÃ o s. Láº·p láº¡i tá»«ng chá»‰ sá»‘ $i$ cá»§a chuá»—i Ä‘Æ°á»£c sá»­a Ä‘á»•i newS. Äá»‘i vá»›i má»—i chá»‰ sá»‘ $i$, khá»Ÿi táº¡o cÃ¡c biáº¿n l vÃ  r báº±ng 1, vÃ  count báº±ng 0. Thá»±c hiá»‡n vÃ²ng láº·p while khi cÃ¡c kÃ½ tá»± táº¡i cÃ¡c chá»‰ sá»‘ $i - l$ vÃ  $i + r$ há»£p lá»‡ vÃ  báº±ng nhau. VÃ²ng láº·p nÃ y má»Ÿ rá»™ng xÃ¢u Ä‘á»‘i xá»©ng Ä‘Æ°á»£c táº­p trung táº¡i chá»‰ sá»‘ i vÃ  Ä‘áº¿m sá»‘ lÆ°á»£ng xÃ¢u Ä‘á»‘i xá»©ng. BÃªn trong vÃ²ng láº·p, tÄƒng count lÃªn 1 vÃ  cáº­p nháº­t l vÃ  r báº±ng cÃ¡ch tÄƒng chÃºng lÃªn 1. Sau khi vÃ²ng láº·p while káº¿t thÃºc, thÃªm Math.ceil(count / 2) vÃ o res. Äiá»u nÃ y lÃ  vÃ¬ má»—i chuá»—i Ä‘á»‘i xá»©ng há»£p lá»‡ Ä‘Æ°á»£c tÃ­nh hai láº§n (má»™t láº§n cho Ä‘á»™ dÃ i láº» vÃ  má»™t láº§n cho Ä‘á»™ dÃ i cháºµn), vÃ¬ váº­y chÃºng ta chia count cho 2 vÃ  láº¥y giÃ¡ trá»‹ lÃ m trÃ²n cá»§a nÃ³. Láº·p láº¡i cÃ¡c bÆ°á»›c 4-7 cho táº¥t cáº£ cÃ¡c chá»‰ sá»‘ $i$ cá»§a chuá»—i Ä‘Æ°á»£c sá»­a Ä‘á»•i newS. Cuá»‘i cÃ¹ng, tráº£ vá» giÃ¡ trá»‹ cá»§a res, Ä‘áº¡i diá»‡n cho tá»•ng sá»‘ lÆ°á»£ng xÃ¢u Ä‘á»‘i xá»©ng trong chuá»—i ban Ä‘áº§u s. Code âŒ¨ï¸ MÃ¬nh dÃ¹ng Javascript Ä‘á»ƒ code bÃ i nÃ y:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 var SubPalindromes = function (s) { let res = 0; // Táº¡o chuá»—i newS Ä‘Æ°á»£c sá»­a Ä‘á»•i tá»« chuá»—i s let newS = \"#\"; for (let i = 0; i \u003c s.length; i++) { newS += s[i] + \"#\"; } // Láº·p qua cÃ¡c vá»‹ trÃ­ trong chuá»—i newS let n = newS.length, l, r, count; for (let i = 0; i \u003c n; i++) { count = 0; l = 1; r = 1; // Kiá»ƒm tra há»£p lá»‡ vÃ  kiá»ƒm tra tÃ­nh Ä‘á»‘i xá»©ng cá»§a chuá»—i con while (i - l \u003e= 0 \u0026\u0026 i + r \u003c n \u0026\u0026 newS[i - l] == newS[i + r]) { count++; l++; r++; } res += Math.ceil(count / 2); } return res; }; $$ \\overbrace{ s_{l+1}\\ \\ldots\n\\underbrace{ s_{j-d_{\\mathrm{odd}}[j]+1}\\ \\ldots\\ s_j\\ \\ldots\\ s_{j+d_{\\mathrm{odd}}[j]-1}\n}\\text{palindrome}\n\\ldots\n\\underbrace{ s{i-d_{\\mathrm{odd}}[j]+1}\\ \\ldots\\ s_i\\ \\ldots\\ s_{i+d_{\\mathrm{odd}}[j]-1}\n}\\text{palindrome}\n\\ldots\\ s{r-1}\n}^\\text{palindrome}\n\\ldots $$\n","wordCount":"1108","inLanguage":"en","image":"https://TrungNgoVan.github.io/blog/images/example.jpg","datePublished":"2023-06-12T17:27:53+07:00","dateModified":"2023-06-12T17:27:53+07:00","author":{"@type":"Person","name":"Ngo Van Trung"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://TrungNgoVan.github.io/blog/docs/manacher-algorithm/"},"publisher":{"@type":"Organization","name":"Sá»• tay cá»§a Henry","logo":{"@type":"ImageObject","url":"https://TrungNgoVan.github.io/blog/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://TrungNgoVan.github.io/blog/ accesskey=h title="ğŸ³ Sá»• tay cá»§a Henry (Alt + H)">ğŸ³ Sá»• tay cá»§a Henry</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://TrungNgoVan.github.io/blog/about/ title=About><span>About</span></a></li><li><a href=https://TrungNgoVan.github.io/blog/categories/ title=Categories><span>Categories</span></a></li><li><a href=https://TrungNgoVan.github.io/blog/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://TrungNgoVan.github.io/blog/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://TrungNgoVan.github.io/blog/cv.pdf title=CV><span>CV</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://TrungNgoVan.github.io/blog/>Home</a>&nbsp;Â»&nbsp;<a href=https://TrungNgoVan.github.io/blog/docs/>Docs</a></div><h1 class=post-title>Manacher's Algorithm</h1><div class=post-meta><span title='2023-06-12 17:27:53 +0700 +0700'>June 12, 2023</span>&nbsp;Â·&nbsp;6 min&nbsp;Â·&nbsp;Ngo Van Trung&nbsp;|&nbsp;<a href=https://github.com/TrungNgoVan/blog/blob/main/content/docs/Manacher-algorithm.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><figure class=entry-cover><img loading=lazy src=https://TrungNgoVan.github.io/blog/images/example.jpg alt=Cover><p>Cover</p></figure><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#th%e1%ba%bf-n%c3%a0o-l%c3%a0-1-palindrome- aria-label="Tháº¿ nÃ o lÃ  1 Palindrome ?">Tháº¿ nÃ o lÃ  1 Palindrome ?</a></li><li><a href=#b%c3%a0i-to%c3%a1n-t%c3%acm-t%e1%ba%a5t-c%e1%ba%a3-c%c3%a1c-sub-palindromes-trong-th%e1%bb%9di-gian-on aria-label="BÃ i toÃ¡n: TÃ¬m táº¥t cáº£ cÃ¡c sub-palindromes trong thá»i gian $O(n)$">BÃ i toÃ¡n: TÃ¬m táº¥t cáº£ cÃ¡c sub-palindromes trong thá»i gian $O(n)$</a><ul><ul><li><a href=#b%c3%a0i-to%c3%a1n aria-label="BÃ i toÃ¡n:">BÃ i toÃ¡n:</a></li><li><a href=#ph%c3%a2n-t%c3%adch aria-label="PhÃ¢n tÃ­ch:">PhÃ¢n tÃ­ch:</a></li></ul></ul></li><li><a href=#code-th%c3%b4i- aria-label="Code thÃ´i ğŸ’»">Code thÃ´i ğŸ’»</a><ul><ul><li><a href=#suy-ngh%c4%a9-ch%c3%bat- aria-label="Suy nghÄ© chÃºt ğŸ¤”">Suy nghÄ© chÃºt ğŸ¤”</a></li><li><a href=#thu%e1%ba%adt-to%c3%a1n- aria-label="Thuáº­t toÃ¡n ğŸ“">Thuáº­t toÃ¡n ğŸ“</a></li><li><a href=#code- aria-label="Code âŒ¨ï¸">Code âŒ¨ï¸</a></li></ul></ul></li></ul></div></details></div><div class=post-content><p>MÃ¬nh má»›i gáº·p vÃ  tÃ¬m hiá»ƒu thuáº­t toÃ¡n nÃ y má»›i Ä‘Ã¢y thÃ´i ğŸ³, khi Ä‘ang lÃ m 1 bÃ i trÃªn <a href=https://leetcode.com/problems/palindromic-substrings/description/>leetcode</a> ğŸ˜ƒ</p><h1 id=tháº¿-nÃ o-lÃ -1-palindrome->Tháº¿ nÃ o lÃ  1 Palindrome ?<a hidden class=anchor aria-hidden=true href=#tháº¿-nÃ o-lÃ -1-palindrome->#</a></h1><p>MÃ¬nh hiá»ƒu <code>palindrome</code> lÃ  1 chuá»—i kÃ½ tá»± Ä‘á»‘i xá»©ng. VÃ­ dá»¥:</p><p><img loading=lazy src=../../images/example.jpg alt=example></p><p>Chuá»—i &ldquo;cabadabac&rdquo; lÃ  1 <code>palindrome</code>. VÃ¬ chuá»—i nÃ y Ä‘á»‘i xá»©ng qua kÃ½ tá»± &rsquo;d&rsquo; á»Ÿ vá»‹ trÃ­ 4 (tÃ­nh tá»« 0, theo cÃ¡ch index trong javascript). Hay chuá»—i &ldquo;acbaabca&rdquo; cÅ©ng lÃ  1 <code>palindrome</code>, chuá»—i nÃ y Ä‘á»‘i xá»©ng qua vá»‹ trÃ­ giá»¯a 2 kÃ½ tá»± &lsquo;a&rsquo;.</p><p>Äá»ƒ dá»… hÃ¬nh dung hÆ¡n, cÃ¡c báº¡n cÃ³ thá»ƒ tÆ°á»Ÿng tÆ°á»Ÿng 1 <code>palindrome</code> Ä‘Æ°á»£c táº¡o ra báº±ng cÃ¡ch pháº£n chiáº¿u 1 chuá»—i kÃ½ tá»± qua &ldquo;gÆ°Æ¡ng&rdquo;.</p><p>Váº­y <code>sub-palindromes</code> (cÃ²n gá»i lÃ  <code>palindrome substrings</code>) lÃ  cÃ¡c chuá»—i con cá»§a má»™t chuá»—i ban Ä‘áº§u vÃ  lÃ  <code>palindrome</code>.</p><p>Theo mÃ¬nh tÃ¬m hiá»ƒu thÃ¬ <code>sub-palindromes</code> lÃ  má»™t khÃ¡i niá»‡m quan trá»ng trong xá»­ lÃ½ chuá»—i vÃ  cÃ³ á»©ng dá»¥ng trong nhiá»u bÃ i toÃ¡n, bao gá»“m tÃ¬m kiáº¿m tá»«, mÃ£ hÃ³a, nÃ©n dá»¯ liá»‡u vÃ  xá»­ lÃ½ ngÃ´n ngá»¯ tá»± nhiÃªn. Trong bÃ i viáº¿t nÃ y mÃ¬nh sáº½ nÃ³i Ä‘áº¿n 1 bÃ i toÃ¡n khÃ¡ hay. Go go ğŸ³</p><h1 id=bÃ i-toÃ¡n-tÃ¬m-táº¥t-cáº£-cÃ¡c-sub-palindromes-trong-thá»i-gian-on>BÃ i toÃ¡n: TÃ¬m táº¥t cáº£ cÃ¡c sub-palindromes trong thá»i gian $O(n)$<a hidden class=anchor aria-hidden=true href=#bÃ i-toÃ¡n-tÃ¬m-táº¥t-cáº£-cÃ¡c-sub-palindromes-trong-thá»i-gian-on>#</a></h1><h3 id=bÃ i-toÃ¡n>BÃ i toÃ¡n:<a hidden class=anchor aria-hidden=true href=#bÃ i-toÃ¡n>#</a></h3><blockquote><p>Cho chuá»—i â€Š$s$â€Š vá»›i Ä‘á»™ dÃ i â€Š$n$â€Š. TÃ¬m táº¥t cáº£ cÃ¡c cáº·p â€Š$(i, j)$â€Š sao cho chuá»—i con â€Š$s[i\dots j]$â€Š lÃ  má»™t chuá»—i Ä‘á»‘i xá»©ng. Chuá»—i â€Š$t$â€Š lÃ  má»™t chuá»—i Ä‘á»‘i xá»©ng khi â€Š$t = t_{rev}$â€Š (â€Š$t_{rev}$â€Š lÃ  má»™t chuá»—i Ä‘áº£o ngÆ°á»£c cá»§a â€Š$t$â€Š).</p></blockquote><h3 id=phÃ¢n-tÃ­ch>PhÃ¢n tÃ­ch:<a hidden class=anchor aria-hidden=true href=#phÃ¢n-tÃ­ch>#</a></h3><ul><li><p>Chuá»—i Ä‘á»‘i xá»©ng á»Ÿ Ä‘Ã¢y chÃ­nh lÃ  <code>palindrome</code> mÃ¬nh Ä‘Ã£ Ä‘á» cáº­p á»Ÿ trÃªn.</p></li><li><p>Trong trÆ°á»ng há»£p xáº¥u nháº¥t, chuá»—i ban Ä‘áº§u cÃ³ thá»ƒ cÃ³ tá»›i â€Š$O(n^2)$â€Š chuá»—i con Ä‘á»‘i xá»©ng. LÃºc Ä‘áº§u mÃ¬nh nhÃ¬n qua thÃ¬ nghÄ© lÃ  khÃ´ng cÃ³ thuáº­t toÃ¡n tuyáº¿n tÃ­nh nÃ o cho bÃ i toÃ¡n nÃ y. Tá»©c lÃ  sáº½ khÃ´ng cÃ³ bÃ i viáº¿t nÃ y ğŸ‘€</p></li><li><p>PhÃ¢n tÃ­ch ká»¹ hÆ¡n ğŸ”: CÃ¡c palindrome sáº½ cÃ³ Ä‘á»™ dÃ i láº» vÃ  cháºµn khÃ¡c nhau, vÃ  Ä‘Æ°á»£c tÃ­nh riÃªng lÃ  â€Š$d_{odd}[i]$â€Š vÃ  â€Š$d_{even}[i]$â€Š. Äá»‘i vá»›i cÃ¡c palindrome cÃ³ Ä‘á»™ dÃ i cháºµn, chÃºng ta giáº£ Ä‘á»‹nh ráº±ng chÃºng cÃ³ tÃ¢m á»Ÿ vá»‹ trÃ­ â€Š$i$â€Š náº¿u hai kÃ½ tá»± trung tÃ¢m cá»§a chÃºng lÃ  â€Š$s[i]$â€Š vÃ  â€Š$s[i-1]$â€Š.</p><p>VÃ­ dá»¥, chuá»—i â€Š$s = abababc$â€Š cÃ³ 3 palindromes cÃ³ Ä‘á»™ dÃ i láº» vá»›i tÃ¢m á»Ÿ vá»‹ trÃ­ â€Š$s[3] = b$â€Š, tá»©c lÃ  $d_{odd}[3] = 3$â€Š:</p><p><img loading=lazy src=../../images/odd.jpg alt="manacher odd"></p><p>VÃ  chuá»—i â€Š$s = cbaabd$â€Š cÃ³ 2 palindromes cÃ³ Ä‘á»™ dÃ i báº±ng nhau vá»›i tÃ¢m á»Ÿ vá»‹ trÃ­ â€Š$s[3] = a$â€Š, tá»©c lÃ  $d_{even}[3] = 2$â€Š:</p><p><img loading=lazy src=../../images/even.jpg alt="manacher even"></p></li></ul><p>Thá»±c táº¿, váº¥n Ä‘á» nÃ y Ä‘Ã£ cÃ³ nhiá»u giáº£i phÃ¡p: vá»›i String Hashing, nÃ³ cÃ³ thá»ƒ Ä‘Æ°á»£c giáº£i quyáº¿t trong â€Š$O(n\cdot \log n)$â€Š, vÃ  vá»›i Suffix Trees vÃ  Fast LCA , váº¥n Ä‘á» nÃ y cÃ³ thá»ƒ Ä‘Æ°á»£c giáº£i quyáº¿t trong $O(n)$â€Š. CÃ¡c báº¡n cÃ³ thá»ƒ tá»± tÃ¬m hiá»ƒu.</p><p>NhÆ°ng thuáº­t toÃ¡n mÃ¬nh nÃ³i trong Ä‘áº¿n trong bÃ i nÃ y Ä‘Æ¡n giáº£n hÆ¡n vÃ  cÃ³ Ã­t háº±ng sá»‘ áº©n hÆ¡n vá» Ä‘á»™ phá»©c táº¡p cá»§a bá»™ nhá»› vÃ  thá»i gian. Thuáº­t toÃ¡n nÃ y Ä‘Æ°á»£c phÃ¡t hiá»‡n bá»Ÿi <strong>Glenn K. Manacher</strong> vÃ o nÄƒm 1975.</p><p>Vá» <strong>Ã½ tÆ°á»Ÿng</strong> cá»‘t lÃµi lÃ  tÃ­nh toÃ¡n sá»‘ lÆ°á»£ng palindrome hiá»‡n táº¡i dá»±a trÃªn thÃ´ng tin palindrome Ä‘Æ°á»£c tÃ­nh toÃ¡n trÆ°á»›c Ä‘Ã³. Nghe giá»‘ng DP nhá»‰ ğŸ‘€</p><h1 id=code-thÃ´i->Code thÃ´i ğŸ’»<a hidden class=anchor aria-hidden=true href=#code-thÃ´i->#</a></h1><h3 id=suy-nghÄ©-chÃºt->Suy nghÄ© chÃºt ğŸ¤”<a hidden class=anchor aria-hidden=true href=#suy-nghÄ©-chÃºt->#</a></h3><p>Äá»ƒ xá»­ lÃ½ váº¥n Ä‘á» palindrome cÃ³ Ä‘á»™ dÃ i láº» vÃ  cháºµn khÃ¡c nhau, thay vÃ¬ tÃ­nh toÃ¡n cho cáº£ 2 trÆ°á»ng há»£p. ChÃºng ta sáº½ biáº¿n Ä‘á»•i chuá»—i ban Ä‘áº§u 1 chÃºt. Cá»¥ thá»ƒ, mÃ¬nh sáº½ thÃªm kÃ½ tá»± <code>#</code> vÃ o Ä‘áº§u, cuá»‘i vÃ  giá»¯a cÃ¡c kÃ½ tá»± cá»§a chuá»—i ban Ä‘áº§u. TrÃ´ng nÃ³ sáº½ nhÆ° váº­y:</p><p><img loading=lazy src=../../images/modify.jpg alt=example></p><p>Sau khi modify chuá»—i, chÃºng ta sáº½ luÃ´n thu Ä‘Æ°á»£c 1 chuá»—i má»›i cÃ³ Ä‘á»™ dÃ i láº». VÃ  sáº½ khÃ´ng cÃ³ trÆ°á»ng há»£p palindrome cÃ³ Ä‘á»™ dÃ i cháºµn táº¡o bá»Ÿi cÃ¡c kÃ½ tá»± trong chuá»—i ban Ä‘áº§u.</p><p>Bá»Ÿi vÃ¬ giá»¯a chÃºng luÃ´n cÃ³ kÃ½ tá»± <strong>&rsquo;#&rsquo;</strong>. Do Ä‘Ã³ chÃºng ta Ä‘Ã£ bá» qua Ä‘Æ°á»£c váº¥n Ä‘á» pháº£i tÃ­nh toÃ¡n sá»‘ lÆ°á»£ng cÃ¡c palindromes cÃ³ Ä‘á»™ dÃ i cháºµn.</p><p>Váº­y giá» mÃ¬nh chá»‰ cáº§n tÃ¬m sá»‘ lÆ°á»£ng cÃ¡c palindrome láº» vÃ  lÆ°u láº¡i. ğŸ‘€ Nghe dá»… nhá»‰</p><h3 id=thuáº­t-toÃ¡n->Thuáº­t toÃ¡n ğŸ“<a hidden class=anchor aria-hidden=true href=#thuáº­t-toÃ¡n->#</a></h3><ol><li>Khá»Ÿi táº¡o má»™t biáº¿n Ä‘áº¿m tÃªn <code>res</code> Ä‘á»ƒ theo dÃµi sá»‘ lÆ°á»£ng xÃ¢u Ä‘á»‘i xá»©ng.</li><li>Táº¡o má»™t chuá»—i Ä‘Æ°á»£c sá»­a Ä‘á»•i <code>newS</code> báº±ng cÃ¡ch chÃ¨n kÃ½ tá»± <code>#</code> giá»¯a má»—i kÃ½ tá»± cá»§a chuá»—i Ä‘áº§u vÃ o s.</li><li>Láº·p láº¡i tá»«ng chá»‰ sá»‘ $i$ cá»§a chuá»—i Ä‘Æ°á»£c sá»­a Ä‘á»•i <code>newS</code>.</li><li>Äá»‘i vá»›i má»—i chá»‰ sá»‘ $i$, khá»Ÿi táº¡o cÃ¡c biáº¿n <code>l</code> vÃ  <code>r</code> báº±ng 1, vÃ  <code>count</code> báº±ng 0.</li><li>Thá»±c hiá»‡n vÃ²ng láº·p while khi cÃ¡c kÃ½ tá»± táº¡i cÃ¡c chá»‰ sá»‘ $i - l$ vÃ  $i + r$ há»£p lá»‡ vÃ  báº±ng nhau. VÃ²ng láº·p nÃ y má»Ÿ rá»™ng xÃ¢u Ä‘á»‘i xá»©ng Ä‘Æ°á»£c táº­p trung táº¡i chá»‰ sá»‘ i vÃ  Ä‘áº¿m sá»‘ lÆ°á»£ng xÃ¢u Ä‘á»‘i xá»©ng.</li><li>BÃªn trong vÃ²ng láº·p, tÄƒng <code>count</code> lÃªn 1 vÃ  cáº­p nháº­t <code>l</code> vÃ  <code>r</code> báº±ng cÃ¡ch tÄƒng chÃºng lÃªn 1.</li><li>Sau khi vÃ²ng láº·p while káº¿t thÃºc, thÃªm <code>Math.ceil(count / 2)</code> vÃ o <code>res</code>. Äiá»u nÃ y lÃ  vÃ¬ má»—i chuá»—i Ä‘á»‘i xá»©ng há»£p lá»‡ Ä‘Æ°á»£c tÃ­nh hai láº§n (má»™t láº§n cho Ä‘á»™ dÃ i láº» vÃ  má»™t láº§n cho Ä‘á»™ dÃ i cháºµn), vÃ¬ váº­y chÃºng ta chia <code>count</code> cho 2 vÃ  láº¥y giÃ¡ trá»‹ lÃ m trÃ²n cá»§a nÃ³.</li><li>Láº·p láº¡i cÃ¡c bÆ°á»›c 4-7 cho táº¥t cáº£ cÃ¡c chá»‰ sá»‘ $i$ cá»§a chuá»—i Ä‘Æ°á»£c sá»­a Ä‘á»•i <code>newS</code>.</li><li>Cuá»‘i cÃ¹ng, tráº£ vá» giÃ¡ trá»‹ cá»§a <code>res</code>, Ä‘áº¡i diá»‡n cho tá»•ng sá»‘ lÆ°á»£ng xÃ¢u Ä‘á»‘i xá»©ng trong chuá»—i ban Ä‘áº§u s.</li></ol><h3 id=code->Code âŒ¨ï¸<a hidden class=anchor aria-hidden=true href=#code->#</a></h3><p>MÃ¬nh dÃ¹ng <strong>Javascript</strong> Ä‘á»ƒ code bÃ i nÃ y:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kd>var</span> <span class=nx>SubPalindromes</span> <span class=o>=</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>s</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kd>let</span> <span class=nx>res</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=c1>// Táº¡o chuá»—i newS Ä‘Æ°á»£c sá»­a Ä‘á»•i tá»« chuá»—i s
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kd>let</span> <span class=nx>newS</span> <span class=o>=</span> <span class=s2>&#34;#&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=k>for</span> <span class=p>(</span><span class=kd>let</span> <span class=nx>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>i</span> <span class=o>&lt;</span> <span class=nx>s</span><span class=p>.</span><span class=nx>length</span><span class=p>;</span> <span class=nx>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>newS</span> <span class=o>+=</span> <span class=nx>s</span><span class=p>[</span><span class=nx>i</span><span class=p>]</span> <span class=o>+</span> <span class=s2>&#34;#&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=c1>// Láº·p qua cÃ¡c vá»‹ trÃ­ trong chuá»—i newS
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kd>let</span> <span class=nx>n</span> <span class=o>=</span> <span class=nx>newS</span><span class=p>.</span><span class=nx>length</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>l</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>r</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>count</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=k>for</span> <span class=p>(</span><span class=kd>let</span> <span class=nx>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>i</span> <span class=o>&lt;</span> <span class=nx>n</span><span class=p>;</span> <span class=nx>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>count</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=nx>l</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=nx>r</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=c1>// Kiá»ƒm tra há»£p lá»‡ vÃ  kiá»ƒm tra tÃ­nh Ä‘á»‘i xá»©ng cá»§a chuá»—i con
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>while</span> <span class=p>(</span><span class=nx>i</span> <span class=o>-</span> <span class=nx>l</span> <span class=o>&gt;=</span> <span class=mi>0</span> <span class=o>&amp;&amp;</span> <span class=nx>i</span> <span class=o>+</span> <span class=nx>r</span> <span class=o>&lt;</span> <span class=nx>n</span> <span class=o>&amp;&amp;</span> <span class=nx>newS</span><span class=p>[</span><span class=nx>i</span> <span class=o>-</span> <span class=nx>l</span><span class=p>]</span> <span class=o>==</span> <span class=nx>newS</span><span class=p>[</span><span class=nx>i</span> <span class=o>+</span> <span class=nx>r</span><span class=p>])</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>count</span><span class=o>++</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=nx>l</span><span class=o>++</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=nx>r</span><span class=o>++</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=nx>res</span> <span class=o>+=</span> <span class=nb>Math</span><span class=p>.</span><span class=nx>ceil</span><span class=p>(</span><span class=nx>count</span> <span class=o>/</span> <span class=mi>2</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=nx>res</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span></code></pre></td></tr></table></div></div><p>$$
\overbrace{
s_{l+1}\ \ldots<br>\underbrace{
s_{j-d_{\mathrm{odd}}[j]+1}\ \ldots\ s_j\ \ldots\ s_{j+d_{\mathrm{odd}}[j]-1}<br>}\text{palindrome}<br>\ldots<br>\underbrace{
s{i-d_{\mathrm{odd}}[j]+1}\ \ldots\ s_i\ \ldots\ s_{i+d_{\mathrm{odd}}[j]-1}<br>}\text{palindrome}<br>\ldots\ s{r-1}<br>}^\text{palindrome}<br>\ldots
$$</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://TrungNgoVan.github.io/blog/tags/math/>math</a></li><li><a href=https://TrungNgoVan.github.io/blog/tags/algorithm/>algorithm</a></li></ul><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share Manacher's Algorithm on twitter" href="https://twitter.com/intent/tweet/?text=Manacher%27s%20Algorithm&url=https%3a%2f%2fTrungNgoVan.github.io%2fblog%2fdocs%2fmanacher-algorithm%2f&hashtags=math%2calgorithm"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Manacher's Algorithm on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fTrungNgoVan.github.io%2fblog%2fdocs%2fmanacher-algorithm%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2023 <a href=https://TrungNgoVan.github.io/blog/>Sá»• tay cá»§a Henry</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>